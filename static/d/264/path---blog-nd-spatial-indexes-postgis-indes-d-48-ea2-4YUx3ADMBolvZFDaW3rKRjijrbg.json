{"data":{"site":{"siteMetadata":{"title":"Spatial Paralysis","author":"Richard Law"}},"markdownRemark":{"id":"617766dd-a56d-5e93-bd64-7becebeb884b","excerpt":"I have just watched Paul Ramsay’s (CartoDB) breakout presentation from  PGConf Silicon Valley 2015 . I love watching these kinds of videos…","html":"<p>I have just watched Paul Ramsay’s (CartoDB) breakout presentation from <em>PGConf Silicon Valley 2015</em>. I love watching these kinds of videos. They’re reasonably short (~40 minutes) so are good while you’re eating lunch or killing time. They also tend to have little nuggets of wisdom to solve “gotchas” that for some reason no one has ever told you about. This presentation in particular has lots of these for using PostGIS. One I did not know about was the ability to specify an n-dimensional index in PostGIS. The typical way to construct a two-dimensional GIST index in PostGIS is to do:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> idx <span class=\"token keyword\">ON</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">USING</span> gist<span class=\"token punctuation\">(</span>geom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>However if you have XYZ or XYZT data and you want to issue queries that take advantage of these additional dimensions with a multidimensional index, you will need:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> idx <span class=\"token keyword\">ON</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">USING</span> gist<span class=\"token punctuation\">(</span>geom gist_geometry_ops_nd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The different operator, internally, means that the spatial functions use the <code class=\"language-text\">&amp;&amp;&amp;</code> operator, rather than the <code class=\"language-text\">&amp;&amp;</code> operator.</p>\n<p>I have been thinking recently about trying to get my hands on some LiDAR data. Acquiring this data is apparently very difficult at the moment. But if you use PostGIS, you’re now well-equipped to deal with it… if you can get your hands on it <img class=\"emoji-icon\" data-icon=\"emoji-information_desk_person\" style=\"display: inline; margin: 0; position: relative; top: 5px; width: 20px\" src=\"data:image/png;base64, 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\"></p>\n<p>In addition, PostGIS allows you to switch out the geometry library from the Geometry Engine Open Source (GEOS) to the SFCGAL (SF (?) Computational Geometry Algorithms Library). SFCGAL is not as broad as GEOS, so if you do make the switch, internally a lot of your functions will still use GEOS. However, as Paul Ramsay notes, SFCGAL has a bunch of additional functions that GEOS does not. These include some interesting 3D functions:</p>\n<ul>\n<li><code class=\"language-text\">ST_3DIntersection</code></li>\n<li><code class=\"language-text\">ST_Tesselate</code></li>\n<li><code class=\"language-text\">ST_3DArea</code></li>\n<li><code class=\"language-text\">ST_Extrude</code></li>\n<li><code class=\"language-text\">ST_ForceLHR</code></li>\n<li><code class=\"language-text\">ST_Orientation</code></li>\n<li><code class=\"language-text\">ST_Minkowski</code></li>\n<li><code class=\"language-text\">ST_StraightSkeleton</code></li>\n<li><code class=\"language-text\">ST_ApproximateMedialAxis</code></li>\n</ul>\n<p>SFCGAL will need to be compiled, and then activated within PostgreSQL:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> EXTENSION postgis_sfcgal<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SET</span> postgis<span class=\"token punctuation\">.</span>backend <span class=\"token operator\">=</span> <span class=\"token string\">'sfcgal'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>There is also a dedicated PostgreSQL extension for storing point cloud data: <a href=\"https://github.com/pgpointcloud/pointcloud\">https://github.com/pgpointcloud/pointcloud</a></p>\n<p>Also in the video, there is a tricky philosophical question, with important geometric implications (never thought I’d say that): <em>What is the intersection of two disjoint polygons?</em> The sound of a tree falling in the woods? The sound of one hand clapping? Close. It’s a polygon representing the presence of nothing: <code class=\"language-text\">POLYGON EMPTY</code>. And empty geometry is not <code class=\"language-text\">NULL</code>. It’s actually more like <code class=\"language-text\">0</code> (something with no magnitude, but not exactly nothing).</p>\n<p>Another way to get <code class=\"language-text\">GEOMETRY EMPTY</code> is to use a negative buffer value that is larger than the geometry that is being buffered.</p>\n<p><div>\n          <div\n            class=\"gatsby-resp-iframe-wrapper\"\n            style=\"padding-bottom: 50%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem\"\n          >\n            <div><iframe src=\"http://www.youtube.com/embed/GSuZP89UdGs\" style=\"\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          \"></iframe></div>\n          </div>\n          </div></p>\n<p>What did you find useful from this presentation?</p>\n<p>Incidentally, if someone can tell me what the “SF” in SFCGAL stands for, I’d really appreciate it. It’s driving me nuts. (Spatial Functions?)</p>","frontmatter":{"title":"3D spatial indexes in PostGIS","date":"02:37 PM, Saturday December 19, 2015","updated":null,"path":null},"fields":{"slug":"/blog/nd-spatial-indexes-postgis/indes/"}}},"pageContext":{"slug":"/blog/nd-spatial-indexes-postgis/indes/","previous":{"fields":{"slug":"/blog/travel-demand/"},"frontmatter":{"title":"Vector fields of population travel demand","updated":null,"date":"2015-12-06T18:16:00.000Z","path":null,"tags":["algorithms"]}},"next":{"fields":{"slug":"/blog/geodata-web-services/"},"frontmatter":{"title":"Geodata web services","updated":null,"date":"2016-01-16T21:04:51.000Z","path":null,"tags":["PostGIS","API","JavaScript","AWS"]}}}}