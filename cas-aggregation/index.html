<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Crash Analysis System: Aggregation Wizardary</title>
  <meta name="description" content="This is a follow-up post to my previous entry, “Crash Analysis System: The Narrative Arc”, in which I describe my on-going dispute with the NZTA about access...">


  <link rel="stylesheet" href="/css/tufte.css">	
  

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not-->
  
    <link href='//fonts.googleapis.com/css?family=Lato:400,400italic' rel='stylesheet' type='text/css'>
  
  <!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

  <link rel="canonical" href="http://www.nearimprov.com/cas-aggregation/">
  <link rel="alternate" type="application/rss+xml" title="nearimprov" href="http://www.nearimprov.com/feed.xml" />
</head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
    <nav class="group">
	<a href="/"><img class="badge" src="/assets/img/new_badge.png" alt="CH"></a>
	
		
		    
		      <a href="/feed.xml"></a>
		    
	    
  	
		
		    
		      <a href="/">blog</a>
		    
	    
  	
		
		    
		      <a href="/about/">About</a>
		    
	    
  	
		
		    
		      <a href="/projects/">Projects</a>
		    
	    
  	
		
  	
	</nav>
</header>

    <article class="group">
      <h1>Crash Analysis System: Aggregation Wizardary</h1>
<p class="subtitle">May 8, 2016</p>


<p><em>This is a follow-up post to my previous entry, <a href="www.nearimprov.com/cas-saga">“Crash Analysis System: The Narrative Arc”</a>, in which I describe my on-going dispute with the NZTA about access to a comprehensive record of road-accident data for New Zealand.</em></p>

<p>Since my last post I’ve had a number of people come forward and demystify aspects of the NZTA’s Crash Analysis System (CAS) that I did not fully appreciate. The NZTA has also come up with the aggregated data I’ve been waiting on for several months. In this post I’ll take you through this new public method of accessing CAS-the-data, and also highlight some of the aspects of CAS that I’ve learned since my last post. The TL;DR is that the aggregation is everything we knew it would be: a shotgun to the balls. There’s no upside to it.</p>

<p>In my last post I included a sample disaggregate CAS record, of a crash in Ashburton. Here it is again:</p>

<p><code class="highlighter-rouge">csv
'Ashburton District','MOORE ST','100','N',' ','WILLIAM ST','201531749','07/02/2015','Sat','2335','EA','CN1V','103A 129A ','M','R','D','DO','F ',' ',' ','C','050','0','0','0','','','1499510','5137544',
</code></p>

<p>Decoded, it might look like this:</p>

<p><br /></p>
<figure><figcaption></figcaption><img src="/./assets/cas-saga/asburton-example.png" /></figure>

<p>Now that the NZTA has <a href="http://www.nzta.govt.nz/resources/crash-analysis-reports/grouped-crash-sites/">released aggregate data</a>, we can compare and contrast the so-called “grouped crash sites”:</p>

<p><code class="highlighter-rouge">csv
201212510,1822862,5530978,I,4,,0,Palmerston North,RUAHINE ST,FEATHERSTON ST,50
</code></p>

<p>There’s a lot less there, but initially it’s actually harder to decode this information, because the NZTA has apparently also taken this opportunity to change how they classify crashes.<label for="sn-id-1" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-id-1" class="margin-toggle" /><span class="sidenote">From January 2016 CAS now uses v4.0 of the <a href="http://www.nzta.govt.nz/assets/resources/guide-to-coded-crash-reports/docs/Factors-contributing-to-crashes-for-use.pdf"><code class="highlighter-rouge">guide-to-coded-crash-reports</code></a>. In case NZTA moves or removes it, download it from me <a href="/assets/cas-saga/guide-to-coded-crash-reports_v4.0.pdf">here</a>. I just hope it’s possible to download the older data in this same schema. </span> The NZTA explains<label for="sn-id-2" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-id-2" class="margin-toggle" /><span class="sidenote">A diff PDF can be obtained from the NZTA <a href="http://www.nzta.govt.nz/assets/resources/guide-to-coded-crash-reports/docs/New-retired-merged-contributory-factors-for-use-from-1-Jan-2016.pdf">here</a>, and from me <a href="/assets/cas-saga/cas-diff.pdf`">here</a>. The changes largely look fine, and they have included conversions between lots of codes they have changed. An interesting new inclusion is <strong>697: Vehicle software failure</strong>, but I’m not sure what <strong>856: Barriers necessary</strong> and <strong>857: Island necessary</strong> are—they sound like policy, not explanations of an accident. Still, props to the NZTA for the semantic versioning, my only real quibble is that a PDF has to be the most annoying format for communicating a table of data. I’ll get around to making a machine-readable format of this in the near future and it will be included in my CAS repository. At that time I’ll also write CAS v4.0 versions of the original data, going back to the year 2000. </span> that</p>

<blockquote>
  <p>Minor changes to some contributory factor codes were made in March [2016]. As mentioned in previous messages, a few new codes have been added, a few have been retired and some have merged into other codes. Where codes have been merged, historical crashes containing merged codes have been updated to reflect that.</p>
</blockquote>

<p>However none of the raw data is available without signing a license agreement. Looking at that aggregated record I included above, there is no crash code at all. Here’s what we get in the aggregate format:</p>

<p><code>
Grouped Site ID: Unique identifier of the crash site
<br /><br />
Grouped Site Easting: Coordinates of the crash site - NZ Transverse Mercator 2000 easting
<br /><br />
Grouped Site Northing: Coordinates of the crash site - NZ Transverse Mercator 2000 northing
<br /><br />
Grouped Site Type: Site type - I (intersection), blank (other)
<br /><br />
Site Crash Count: Number of crashes at this site
<br /><br />
Site Location Direction: The direction of the crash from the reference point. Values N, E, S, W
<br /><br />
Site Location Distance: The distance of the crash from the reference point for the crash (often the intersection of 'Crash Road' and 'Side Road')
<br /><br />
Territorial Local Authority: Territorial local authority where the crash occurred
<br /><br />
Crash Road: Part one of the crash location. May be a road name, state hIghway route position, landmark, or other
<br /><br />
Side Road: Part 2 of the crash location. May be a side road name, landmark etc
<br /><br />
Speed Limit: The speed limit in force at the crash site at the time of the crash
</code></p>

<p>We see that in the metadata “crash” is used in the singular, when the whole point of the aggregate data is that we cannot be trusted with individual accidents any longer.</p>

<p>By eyeballing this record I can tell you that four injury-causing (or fatal) accidents have happened at this one site in Palmerston North, within 30m of the intersection of Ruahine Street and Featherston Street, at some point in the period from 1 July 2012 to 30 June 2015.</p>

<p><strong>That’s literally all I can tell you.</strong></p>

<p>I can’t tell you what modes of transport were involved (car, truck, cyclist?). The speed limit says 50 km/h, but does that actually apply to both streets? From the metadata I can tell you that these must only include accidents with minor injuries or worse, but I can’t even say whether or not someone has died here, or how. I don’t even know when these crashes happened, or when the first and last crashes in the group occurred. The “Grouped Site ID” looks suspiciously like a date (201212510 → December 2012?), but I’m just guessing and there’s no way they all happened at once so even if it was a date it would be almost useless for many types of analytical question. Did they happen at night? At the weekend? Was someone drunk in one or all of these crashes? Hell, maybe I’m just going to start making shit up since we have no other real option.</p>

<p>A large proportion of the original data was no-injury crashes, which now are completely absent, not even present in aggregate. These are almost certainly under-represented in CAS… but what kind of response is this? Accidents that are under-represented are not really candidates for redaction.</p>

<p><br /></p>
<figure><figcaption>A disclaimer that comes with the aggregate data, inside the spreadsheet. Note that I can't even open the original .xlsx on my computer due to (I assume) the gross formatting the NZTA has thrown into the spreadsheet; LibreOffice Calc complains that the file has been corrupted. I agree.</figcaption><img src="/./assets/cas-saga/meta.png" /></figure>

<p>To top it off, the CAS data is still late: following the old CAS data schedule, we’d have disaggregate data up to December 2015 by now, rather than just June 2015: so we’re six months late and severely short-changed.</p>

<p>I wouldn’t be so mad about this if I didn’t know the NZTA collects better information than this, but they do. Apparently the public just can’t be trusted with it. We’ve even progressed down Randall’s file-extension-trustworthiness-index, from the heights of a <code class="highlighter-rouge">.csv</code>:</p>

<p><br /></p>
<figure class="fullwidth"><img src="http://imgs.xkcd.com/comics/file_extensions.png" /><figcaption></figcaption></figure>

<p>Actually, we’ve gone even further back (in time). I found reference to another Microsoft Excel application last week. Inside there is <a href="https://www.nzta.govt.nz/resources/road-safety-wizard/">a magic wizard</a>.<label for="mf-id-wizard" class="margin-toggle">⊕</label><input type="checkbox" id="mf-id-wizard" class="margin-toggle" /><span class="marginnote"><img class="fullwidth" src="/./assets/cas-saga/wizard.gif" /><br />Greetings from the Computer Wizard… in all seriousness, this is probably a good thing for some people. But I hardly think it’s controversial to suggest that in 2016 we can easily make tools at least twice as good as an Excel Macro Wizard.</span></p>

<p>This seems to somehow make a connection to the NZTA’s servers to download five years of CAS data on demand, and can tell you about the crash factors, road type, lightning, and weather conditions. I’d tell you more, but I can’t actually use the Wizard because I don’t have Microsoft Office. I said this last time but it’s worth repeating with emphasis: <strong>if you require people to have licenses for proprietary software to access open data, the data is not open.</strong> It’s 2016, we ought to be making web applications, not spreadsheet wizards.</p>

<p>You can take a gander at the wizard in this PDF from the NZTA <a href="https://www.nzta.govt.nz/assets/userfiles/transport-data/safety-suburb-help.pdf">here</a>, and from me <a href="/assets/cas-saga/safety-suburb-help">here</a>. It’s worth noting that even this tool is severely limited: you can only filter on four crash factors: alcohol, overtaking, speed, and fatigue (I don’t know exactly which factor codes are included, or how). In addition, you can only see down to a suburb level, so the aggregation here is even more severe.</p>

<h1 id="other-things-ive-learnt-about-cas">Other things I’ve learnt about CAS</h1>

<p>According to the Way Back Machine, the NZTA has published the original CSV data (or something like it) since at least 2006. Glen Koorey mentioned in a comment on the first post that CAS-the-system is about 15 years old, which marries with how much data used to be available for download without signing a license agreement. I learnt a little about Citrix, and apparently there are non-Windows clients that will enable interested parties to explore CAS via NZTA’s interface. Personally I’m still not into that: my problem is that I want to create my own data exploration tool for CAS. <strong>CAS was never intended for general public consumption; I want to make it so it is.</strong></p>

<p>Glen also mentioned that a CAS upgrading program has been underway for a few years. One can get on the mailing list for this at <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#099;&#097;&#115;&#114;&#101;&#112;&#108;&#097;&#099;&#101;&#109;&#101;&#110;&#116;&#064;&#110;&#122;&#116;&#097;&#046;&#103;&#111;&#118;&#116;&#046;&#110;&#122;">&#099;&#097;&#115;&#114;&#101;&#112;&#108;&#097;&#099;&#101;&#109;&#101;&#110;&#116;&#064;&#110;&#122;&#116;&#097;&#046;&#103;&#111;&#118;&#116;&#046;&#110;&#122;</a>. Frankly it’s hard to see much fruit.</p>

<p>The other <em>very interesting tidbit</em> that I discovered from one my readers is that the CAS interface (the one you get via Citrix after signing the license agreement) actually <em>allows you to download the disaggregate information in the exact same schema as the original CSVs</em>. For a higher fee, super-users can actually see super-disaggregate data that surely has some serious privacy considerations: records include names, addresses, Police sketches, Police comments, etc.</p>

<p>Apparently not just anyone can get a license to CAS (you need to justify why you need access),<label for="sn-id-5" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-id-5" class="margin-toggle" /><span class="sidenote">Although I’ve been offered it twice without giving a specic road-safety justification.  </span> and (I hope) not just anyone in that subset can access the information that is actually sensitive. A basic CAS license costs $500 per year.<label for="sn-id-6" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-id-6" class="margin-toggle" /><span class="sidenote">Though it’s very likely that it no longer costs anything—I have recieved conflicting information on this matter. </span> The extended license costs up to $3000 a year.<label for="sn-id-4" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-id-4" class="margin-toggle" /><span class="sidenote">Disclaimer: not an official source of information. </span></p>

<h2 id="heres-some-raw-data">Here’s some raw data…</h2>

<p><strong>…since the NZTA isn’t exactly giving it away like candy</strong></p>

<p>To prove the utter pointlessness of the NZTA’s licensing system for access to (basic) CAS data: <a href="/assets/cas-saga/all-crashes-nz-2015.csv">here’s the disaggregate data that I’ve been wanting all year, as a CSV</a>. Note that this uses the new, v4.0 crash factor codes, so it’s not as easy  to ingest. It does overlap the first-quarter 2015 data I already have available on Github, so you can do a diff easily. When I get some time, I’ll update my original web application so you can explore this data at your leisure: it will be the only way you can explore the disaggregate data without NZTA pre-approval!</p>

<p>I suppose there’s a mild ethical issue at stake here: strictly speaking I know I shouldn’t be disemminating this data. But I haven’t actually signed anything to say I can’t. I recieved this information from a third party who I won’t ever reveal. But the fact that I did get my hands on it is pretty indicative of how pointless NZTA’s restrictions are. <strong>The public can still access the disaggregate data, so the privacy argument is moot.</strong> All that the NZTA is achieving is frustration and a disempowering of the general public in matters of road safety information, while increasing their own internal costs.</p>

<p>In the next few days I’ll be submitting some requests for information under the OIA to bring more light on the decisions that have led to this point.</p>



<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'nearimprov';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

 <!--
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'nearimprov';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

-->

    </article>
    <span class="print-footer">Crash Analysis System: Aggregation Wizardary - May 8, 2016 - Richard Law</span>
    <footer>
  <hr class="slender">
  <ul class="footer-links">
    
      <li>
        <a href="//www.twitter.com/alphabeta_soup"><span class="icon-twitter"></span></a>
      </li>
    
      <li>
        <a href="//plus.google.com/+RichardLawNZ"><span class="icon-googleplus"></span></a>
      </li>
    
      <li>
        <a href="//github.com/alpha-beta-soup"><span class="icon-github"></span></a>
      </li>
    
      <li>
        <a href="/blog/feed.xml"><span class="icon-feed"></span></a>
      </li>
    
      <li>
        <a href="mailto:richard.m.law@gmail.com"><span class="icon-mail"></span></a>
      </li>
    
  </ul>
<div class="credits">
<!-- <span>&copy; 2016 &nbsp;&nbsp;RICHARD LAW</span></br> <br> -->
<span>This site is created with the <a href="//github.com/clayh53/tufte-jekyll">Tufte theme </a> for <a href="//jekyllrb.com">Jekyll</a>.</span>
</div>
</footer>

  </body>
</html>
